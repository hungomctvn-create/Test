Các bước cài đặt OpenCV 4.8.1 trực tuyến
1. Cập nhật hệ thống
Đảm bảo hệ thống được cập nhật để tránh xung đột gói:
textsudo apt update
sudo apt upgrade -y
2. Cài đặt các phụ thuộc cần thiết
Cài đặt các thư viện và công cụ cần thiết để build OpenCV:
textsudo apt install -y build-essential cmake git libatlas-base-dev gfortran \
libjpeg-dev libpng-dev libtiff-dev libavcodec-dev libavformat-dev libswscale-dev \
libv4l-dev libxvidcore-dev libx264-dev libgtk-3-dev libatlas-base-dev gfortran \
python3-dev python3-pip python3-numpy libtbb2 libtbb-dev libdc1394-22-dev
3. Tải nguồn OpenCV 4.8.1
Tải phiên bản 4.8.1 từ trang GitHub chính thức của OpenCV:
textcd ~
wget -O opencv.zip https://github.com/opencv/opencv/archive/4.8.1.zip
unzip opencv.zip
mv opencv-4.8.1 opencv
rm opencv.zip
(Tương tự tải OpenCV contrib để hỗ trợ thêm module, ví dụ: face detection):
textwget -O opencv_contrib.zip https://github.com/opencv/opencv_contrib/archive/4.8.1.zip
unzip opencv_contrib.zip
mv opencv_contrib-4.8.1 opencv_contrib
rm opencv_contrib.zip
4. Chuẩn bị thư mục build
Tạo thư mục build và chạy cmake:
textmkdir ~/opencv/build
cd ~/opencv/build
cmake -D CMAKE_BUILD_TYPE=RELEASE \
      -D CMAKE_INSTALL_PREFIX=/usr/local \
      -D OPENCV_EXTRA_MODULES_PATH=~/opencv_contrib/modules \
      -D ENABLE_NEON=ON \
      -D ENABLE_VFPV3=ON \
      -D WITH_TBB=ON \
      -D WITH_V4L=ON \
      -D WITH_QT=ON \
      -D WITH_OPENGL=ON \
      -D WITH_CUBLAS=OFF \
      -D BUILD_opencv_python3=ON \
      -D INSTALL_PYTHON_EXAMPLES=ON \
      -D OPENCV_ENABLE_NONFREE=ON \
      -D BUILD_EXAMPLES=ON ..

Lưu ý: Thay đổi các flag tùy theo nhu cầu (ví dụ: tắt WITH_QT nếu không cần GUI).
Nếu gặp lỗi clock skew (như trước đây), chạy find . -exec touch {} \; trong thư mục opencv và build trước khi cmake.

5. Build và cài đặt
Build OpenCV (sử dụng số thread phù hợp, ví dụ -j4 cho 4 core):
textmake -j4
sudo make install
sudo ldconfig

Thời gian build có thể mất từ 1-2 giờ tùy cấu hình máy.

6. Kiểm tra cài đặt
Kiểm tra xem OpenCV đã cài đặt thành công chưa:
textpython3 -c "import cv2; print(cv2.__version__)"

Nếu ra 4.8.1, cài đặt thành công.

7. Khắc phục lỗi (nếu có)

Clock skew: Nếu build dừng ở 16% với lỗi "Operation not permitted", đồng bộ thời gian (xem các bước trước: sudo timedatectl set-ntp true hoặc sudo ntpdate pool.ntp.org sau khi dừng systemd-timesyncd).
Bộ nhớ thấp: Nếu RAM thiếu, thêm swap:
textsudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile

Lỗi thư viện: Cài thêm gói thiếu (ví dụ: libgtk-3-dev nếu thiếu GUI).

Lưu ý

Nếu dùng Raspberry Pi thực tế (ARM), các flag như ENABLE_NEON phù hợp. Với VirtualBox x86 (như log trước), có thể tắt các flag ARM và kiểm tra lại.
Sau khi cài, chạy lại dự án của bạn để kiểm tra.

Nếu gặp lỗi cụ thể trong quá trình, cung cấp log chi tiết để tôi hỗ trợ thêm!